# НАЗНАЧЕНИЯ И ЗОНА ОТВЕТСТВЕННОСТИ СЕРВИСОВ

1. Сервис оформления заказов
  - Название контекста: Order Service
  - Стратегическая классификация: Core (основной домен)
  - Описание контекста: принимает запросы от клиентов и распределяет задачи между другими сервисами. Отвечает за жизненный цикл заказа
  - Бизнес правила контекста: 
      - Заказ требует выбора магазина (возможно предусмотреть авто предложение из ближайших точек продаж, если определилась геолокация пользователя) и способа получения (самовывоз или доставка).
      - К сформированным заказам могут применяться акции.
      - Онлайн-оплата завершает заказ автоматически, оплата наличными – вручную
      - Заказ может быть создан оператором от имени клиента
      - Заказ не может быть создан без минимальных данных клиента, а именно:
        - зарегистрированные клиенты – id
        - незарегистрированные клиенты – email и телефон
      - Для доставки должен быть подтвержден мобильный телефон.
    - Общий язык контекста: заказ, корзина, статус, способ получения, оплата
    - Возможности
    - Запрос информации: данные клиента (от сервиса аутентификации), доступные магазины (от сервиса управления магазинами), скидки и акции (от сервиса акций), статус заказа (от сервиса доставки)
    - Действия: создание заказа, координация оплаты/доставки, обновление статуса
    - Внешние и внутренние зависимости
    - Внутренние: сервисы: аутентификации,  управления магазинами, акции, оплаты,  доставки, уведомления
    - Внешние: нет прямых зависимостей (опосредованно через сервис оплаты)

2. Сервис аутентификации
   - Название контекста: Authentication Service
   - Стратегическая классификация: Supporting (под-домен)
   - Описание контекста: обеспечивает идентификацию клиентов, выдачу токенов и управление доступом
   - Бизнес правила контекста:
   	- Регистрация клиентов:
   		- Физические лица предоставляют: имя, адрес электронной почты (уникальный), пароль, подтверждение пароля.
  		- Юридические лица: название организации, ИНН (уникальный), адрес электронной почты, пароль, подтверждение пароля.  
	- Все клиенты должны дать согласие на обработку персональных данных перед регистрацией.  
	- Регистрация завершается подтверждением email через переход по уникальной ссылке, отправленной системой.
	- Двухфакторная аутентификация (2FA):
 		- Клиент может активировать 2FA, указав номер телефона.
   		- Подключение завершается вводом временного кода, полученного через SMS.
     		- 2FA требуется для входа с новых устройств.
	- Вход в приложение:  
		- Физические лица: адрес электронной почты и пароль.  
		- Юридические лица: ИНН и пароль.  
		- После успешного входа выдается JWT-токен с ограниченным сроком действия.
	- Сброс пароля: 
		- Клиент запрашивает восстановление через email, получает временную ссылку и подтверждает новый пароль.
		- Общий язык контекста: токен, клиент, сессия, 2FA, регистрация,  сброс пароля, авторизованный и неавторизованный пользователь
	- Возможности:
		- Запрос информации: Проверка валидности JWT-токена. Предоставление профиля клиента (имя, email, статус 2FA) другим сервисам.
	- Действия:  
		- Регистрация нового клиента (создание учетной записи).  
		- Аутентификация (выдача JWT-токена).
		- Сброс пароля (генерация ссылки, обновление пароля).  
		- Управление 2FA (отправка кода, подтверждение устройства).
	- Внешние и внутренние зависимости
		- Внутренние: 
			- Сервис уведомлений (отправка SMS, письмо со ссылкой)
			- Сервис акций (запрос статуса клиента для применения акций)
			- Сервис заказов (запрос токена)
			- Сервис доставки (запрос данных об адресе доставки)
	- Внешние: SMTP (email), SMS-провайдер

4. Сервис управления магазинами
Название контекста: Store Management Service
Стратегическая классификация: поддомен
Описание контекста: 
Хранит данные о магазинах франшизы, а именно адрес, телефон, меню, время работы, загруженность. Обеспечивает информацию для выбора магазина при создании заказа, расчета времени готовности и определения доступности доставки. 
Бизнес-правила контекста:  
Магазин должен быть активен (статус «Открыт») для принятия заказов.  
Доставка доступна только для магазинов, поддерживающих эту услугу (указывается в данных магазина).  
Время работы магазина привязано к его временной зоне, определяемой по геолокации магазина.  
Загруженность магазина рассчитывается на основе текущих заказов и используется для оценки времени готовности заказа.  
Каждый магазин имеет уникальный идентификатор и адрес для предотвращения дублирования. Общий язык контекста: магазин, адрес, меню, статус, загруженность, время работы, геолокация, доставка.
Возможности и ответственность: Запрос информации: 
Список магазинов по геолокации клиента (например, ближайшие точки).  
Данные конкретного магазина: меню, адрес, время работы, текущая загруженность, поддержка доставки.
Оценка времени готовности заказа на основе загруженности.
Действия: 
Обновление данных магазина (меню, время работы, загруженность).
Пересчет загруженности на основе данных о заказах (в реальном времени или периодически).
Внешние и внутренние зависимости: Внутренние: Сервис заказов, Сервис доставки.  
Внешние: нет

5. Сервис расчета скидок и акций
Название контекста: Discount Service
Стратегическая классификация: основной домен
Описание контекста: Управляет скидками, акциями и бонусами. Сервис делает заказы выгоднее для клиентов.
Бизнес-правила контекста:  
Национальные акции доступны всем, локальные — по магазину.  
Бонусы начисляются только зарегистрированным клиентам.
Общий язык контекста: скидка, акция, бонус.
Возможности и ответственность:
Запрос информации: Доступные акции, бонусы клиента.  
Действия: Применение скидки, начисление бонусов (например, «значок колбаска»).
Внешние и внутренние зависимости:
Внутренние: Сервис заказов
Внешние: Нет.
 6. Сервис оплаты
Название контекста: Payment Service
Стратегическая классификация: основной домен
Описание контекста: обрабатывает платежи: онлайн, при доставке, в магазине. 
Бизнес-правила контекста:  
Онлайн-платеж подтверждает заказ сразу.  
Оплата курьеру требует ручного подтверждения.
Клиент физическое лицо может оплатить по карте, онлайн через банковский сервис, по QR-коду или наличными. Для юридических лиц доступна оплата только по счету
Общий язык контекста: платеж, транзакция, метод оплаты.
Возможности и ответственность: Запрос информации: статус транзакции.  
Действия: инициация оплаты, фиксация метода (наличные/карта).
Внешние и внутренние зависимости:
Внутренние: Сервис заказов, сервис доставки, сервис уведомлений  
Внешние: Платежные шлюзы (например, от Сбербанка, Ykassa, Atol).
 7. Сервис доставки
Название контекста: Delivery Service
Стратегическая классификация: основной домен
Описание контекста: организует доставку заказов, управляет курьерами и маршрутами. 
Бизнес-правила контекста:  
Доставка возможна только для заказов с адресом.  
Маршрут учитывает трафик.
Учитывается загрузка курьеров
Общий язык контекста: доставка, маршрут, курьер
Возможности и ответственность:
Запрос информации: статус доставки, время прибытия курьера.  
Действия: назначение курьера, расчет маршрута.
Внешние и внутренние зависимости:
Внутренние: Сервис доставки, сервис управления магазинами, сервис уведомлений, сервис оплаты.  
Внешние: Картографические API.

8. Сервис уведомлений
Название контекста: Notification Service
Стратегическая классификация: generic под-домен
Описание контекста: Отправляет сообщения клиентам и курьерам о статусе заказов и других событиях. 
Бизнес-правила контекста:  
Уведомления отправляются в реальном времени.  
Чек/факс обязателен для доставки.
Уведомления направляются клиенту: при аутентификации/входе в систему, формировании заказа, оплате заказа, статусе заказа, статусе доставки
Общий язык контекста: уведомление, push-сообщение, email
Возможности и ответственность: Запрос информации: Нет.  
Действия: Отправка сообщений.
Внешние и внутренние зависимости: Внутренние: сервис заказов, сервис аутентификации, сервис оплаты, сервис заказов, сервис акций.  
Внешние: Push-сервис, SMTP, SMS-провайдер.

